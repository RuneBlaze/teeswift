require('teeswift')

local nw = "(((((COLLI:0.10374812919279975676,CAPCA:0.07285820959258730578)72:0.01687633680392261470,((CHAPE:0.09436074887800374733,CALAN:0.20253965688958708302)81:0.02742615135783911876,(PICPU:0.21751383294136364399,(OPHHO:0.09675872794281610567,((MELUN:0.08887850140662424681,NESNO:0.05874177300058070622)100:0.06995967804137828705,(ACACH:0.11286773318738121952,((CORBR:0.03358217852721183394,(GEOFO:0.05523736608468161891,TAEGU:0.03530042644379066674)100:0.05363464311987679867)100:0.10566225761538157457,MANVI:0.07521604544639204359)94:0.02739670354302274277)87:0.01766137251847924028)63:0.00544202821240259618)51:0.00316666983787007930)27:0.00274070754266861902)16:0.00000196869490312238)54:0.00977444841055891828,(EURHE:0.10159343709480662954,((PHACA:0.08584793545984133190,(FULGL:0.05354739058566788945,(APTFO:0.00913129287756810938,PYGAD:0.02297643158428801236)100:0.06845647756872645651)61:0.01037777695888693341)5:0.00000196869490312238,((GAVST:0.06175530757699851381,(TAUER:0.08240929784069504771,PHALE:0.06519004947996714927)26:0.00429286290202376616)22:0.00273303677117812385,((EGRGA:0.03383695486236295430,PELCR:0.03399545656749024258)59:0.00152968866382312621,NIPNI:0.05645231821438039671)74:0.01263761265503960882)3:0.00000196869490312238)29:0.00209062282265232982)79:0.00983723114729546586)89:0.02411800220691390911,(((CHLUN:0.09586641091813387361,BALRE:0.06468407628202049731)36:0.00698054372731473499,(CHAVO:0.08867093965953791457,((MESUN:0.09741720084819313619,((PODCR:0.06283968350294601157,PHORU:0.04937783489016153021)54:0.00625245935973366574,CUCCA:0.11506218702666083653)29:0.00446978217566842799)28:0.00619130356480267728,((CATAU:0.07130541874086816778,(((COLST:0.20112645217282462684,FALPE:0.08546516798573794427)51:0.00961300428540062465,CARCR:0.02574304172267912610)26:0.00350533885725209026,(((BUCRH:0.08749980421698314026,(LEPDI:0.11251088435859424308,APAVI:0.11214943798148015175)25:0.00112902455354903317)34:0.00424804398952821453,((HALLE:0.00000196869490312238,HALAL:0.00000196869490312238)100:0.08990167493577440327,MERNU:0.08314516926356781135)14:0.00000196869490312238)26:0.00861349530233438895,TYTAL:0.10298062541052484253)23:0.00087686834626606253)12:0.00370507739587786497)16:0.00364511139986219927,PTEGU:0.11563697309606628394)14:0.00542440930924274322)33:0.00521450426208774909)14:0.00000196869490312238)93:0.04396199247384282444,(ANAPL:0.19285063663720022897,(GALGA:0.02283234311805707253,MELGA:0.06200609429258526623)55:0.00228419673746398360)100:0.09283249756683750742)56:0.00010680300439297902)86:0.01534176395895781725,(STRCA:0.14961763263528296553,TINMA:0.15817124355863812490)86:0.01534176395895781725);"
-- local nw = "((1,2)a,(3,4)b)r;"
local t = read_tree_newick(nw)
-- print(t:newick())
-- print(t:copy():newick())
local pprint = require('pprint')
t:suppress_unifurcations()

for n in t:extract_subtree(t.root[1][1]):traverse_leaves() do
    -- print(n:is_root())
    print(n:newick())
    -- pprint(n)
    -- break
    -- print(n:newick())
end
-- print(read_tree_newick(t:newick()):newick())